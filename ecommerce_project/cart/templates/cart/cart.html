<!-- cart/templates/cart/cart.html -->
{% extends 'base.html' %}
{% load humanize %}

{% block title %}Sepetim - E-Ticaret{% endblock %}

{% block content %}
<h2 class="mb-4">Sepetiniz</h2>

{% if items %}
  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <thead>
        <tr>
          <th>#</th>
          <th>Ürün</th>
          <th>Varyant</th>
          <th>Adet</th>
          <th>Birim Fiyat</th>
          <th>Toplam</th>
          <th>İşlemler</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td>
              <a href="{{ item.product.get_absolute_url }}">{{ item.product.name }}</a>
            </td>
            <td>{{ item.variant.variant_name }}</td>
            <td>
              <form action="{% url 'update_cart_item' item.id %}" method="post" class="d-inline">
                {% csrf_token %}
                <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="form-control d-inline w-50">
                <button type="submit" class="btn btn-sm btn-primary ms-1">Güncelle</button>
              </form>
            </td>
            <td>{{ item.variant.price|floatformat:2 }}₺</td>
            <td>{{ item.get_item_price|floatformat:2 }}₺</td>
            <td>
              <a href="{% url 'remove_from_cart' item.id %}" class="btn btn-danger btn-sm">Sil</a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="d-flex justify-content-end">
    <h5>Toplam: {{ total_price|floatformat:2 }}₺</h5>
  </div>

  <div class="mt-3 d-flex justify-content-end">
    <a href="#" class="btn btn-success">Ödeme Yap</a>
  </div>
{% else %}
  <p>Sepetinizde ürün yok. <a href="{% url 'home' %}">Alışverişe devam et</a>.</p>
{% endif %}
{% endblock %}
